<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
        xmlns:p="http://www.springframework.org/schema/p"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:tx="http://www.springframework.org/schema/tx"
        xmlns:context="http://www.springframework.org/schema/context"
        xmlns:batch="http://www.springframework.org/schema/batch"
  xmlns:mvc="http://www.springframework.org/schema/mvc"

        xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-3.1.xsd
        http://www.springframework.org/schema/context
        http://www.springframework.org/schema/context/spring-context-3.1.xsd
        http://www.springframework.org/schema/tx
        http://www.springframework.org/schema/tx/spring-tx-3.1.xsd
        http://www.springframework.org/schema/batch
        http://www.springframework.org/schema/batch/spring-batch-2.0.xsd
  http://www.springframework.org/schema/mvc
  http://www.springframework.org/schema/mvc/spring-mvc-3.1.xsd
        "
  default-autowire="byName">

   <!--  configure properties files -->
    <bean id="propertyPlaceholderConfigurer"  
    class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer">  
      <property name="locations">  
        <list>  
          <value>classpath:database.properties</value>  
          <value>classpath:authentication.properties</value>
          <value>classpath:email.properties</value>
        </list>  
      </property>  
  </bean> 
    
  <!-- <import resource="file:C:/projects/fox/wasp/target/wasp-0.0.1-SNAPSHOT/WEB-INF/spring/security-app-context.xml"/> -->
   
  <import resource="file:/home/ewah/wasp/target/wasp-0.0.1-SNAPSHOT/WEB-INF/spring/security-app-context.old.xml"/>

  <bean id="messageSource" class="edu.yu.einstein.wasp.service.impl.WaspMessageSourceImpl" >
        <!-- property name="useCodeAsDefaultMessage" value="true"/-->
  </bean>

  <bean id="dataSource" class="org.apache.commons.dbcp.BasicDataSource">
    <property name="driverClassName"><value>com.mysql.jdbc.Driver</value></property>
    <property name="url"><value>jdbc:mysql://localhost:3306/wasp</value></property>
    <property name="username"><value>wasp</value></property>
    <property name="password"><value>waspV2</value></property>
  </bean>



 <bean id="entityManagerFactory" class="org.springframework.orm.jpa.LocalContainerEntityManagerFactoryBean">
   <property name="persistenceUnitName" value="waspPU" />
        <property name="dataSource" ref="dataSource" />
        <property name="jpaVendorAdapter">
            <bean class="org.springframework.orm.jpa.vendor.HibernateJpaVendorAdapter">
                <property name="database" value="MYSQL" />
                <property name="showSql" value="true" />
            </bean>
        </property>   
  </bean>

  <bean name="transactionManager" class="org.springframework.orm.jpa.JpaTransactionManager">
    <property name="entityManagerFactory" ref="entityManagerFactory" />
  </bean>


  <tx:annotation-driven transaction-manager="transactionManager" />

  <bean class="org.springframework.orm.jpa.support.PersistenceAnnotationBeanPostProcessor" /> 

   
    <context:component-scan base-package="util.spring" />
    <context:component-scan base-package="edu.yu.einstein.wasp.dao.impl" />
    <context:component-scan base-package="edu.yu.einstein.wasp.service.impl" /> <!--    <context:component-scan base-package="edu.yu.einstein.wasp.batch" />
    <context:component-scan base-package="edu.yu.einstein.wasp.load" /> --> 
    <context:annotation-config/>


   <bean id="mailSender" class="org.springframework.mail.javamail.JavaMailSenderImpl">
      <property name="host" value="localhost"/>
      <property name="defaultEncoding" value="UTF-8" />
      <property name="javaMailProperties">
                <props>
               <prop key="mail.smtp.from">ewah@ewah.com</prop>
            </props>
      </property>
   </bean>

   <bean id="velocityEngine" class="org.springframework.ui.velocity.VelocityEngineFactoryBean">
      <property name="velocityProperties">
         <value>
          resource.loader=class
          class.resource.loader.class=org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader
         </value>
      </property>
   </bean>

   <bean class="org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping" />
   <bean class="org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter" />
   
   <mvc:annotation-driven />

  <mvc:interceptors>
    <bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
        <property name="paramName"><value>setUserLocale</value></property>
    </bean>

  </mvc:interceptors>

  <!-- loads load scripts to update database -->
  <import resource="classpath*:wasp/*Load.xml" />

  <!-- Spring Integration/Batch config--> 


  <import resource="batch/spring-integration-batch.xml" />

  <bean class="org.springframework.batch.core.scope.StepScope" />

  <import resource="batch/si.xml" />

  <!-- loads all the batch -->
<!--  <import resource="classpath*:batch/*Batch.xml" /> -->

  <import resource="batch/jobCreatedBatch.xml" />
<!--  '*Batch' handles this
  <import resource="batch/quoteQuotedBatch.xml" />
  <import resource="batch/piApprovedBatch.xml" />
  <import resource="batch/daApprovedBatch.xml" /> -->


<!--
  <import resource="import-poll-files-job.xml" /> -->

  <!--  <import resource="bee-job-filepoller.xml" /> -->
  <!-- Spring Integration/Batch config: END -->
 
<!-- 
    <import resource="classpath:/META-INF/module-context.xml"/>

   <bean id="xmlOutputFile" class="org.springframework.core.io.FileSystemResource">
     <constructor-arg value="persons.xml"/>
  </bean>

  <bean id="sampleDir" class="java.io.File">
    <constructor-arg index="0" value="C:\apps\tomcat70eintstein\temp" />
  </bean>
-->

</beans>
